extends public/base.pug

block scripts
  script project_id=#{meta.id}; project_path='/uploads';
  script(src='/vendor/zepto.smoothscroll.js')
  script(src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.44.0/mapbox-gl.js')
  link(href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.44.0/mapbox-gl.css',rel='stylesheet')
  script(src='/scripts/main.js')

block content
  .container(style="margin:100px")

  .container-fluid.no-padding.story
    .container
      .row
        .col-md-12.page-meta
          if organisation
            .authorImage
              a(href=organisation.url,target="_blank")
                img(src=organisation.logo,title=organisation.name)
          h1
            =meta.title
          if meta.summary
            p.description
              =meta.summary

      .row
        .col-md-8
          .page-content
            !=content

        .col-md-4.side-info
          .timestamp
            .created
              span Publiziert am:&nbsp;
              =created
            .updated
              span Aktualisiert am:&nbsp;
              =updated
            .version
              span Version:&nbsp;
              =version

          if organisation
            h3 Sammlung
            p.authorText
              a(href=organisation.url,target="_blank")
                .organisation
                  =organisation.name

          if authors
            h3 Authoren
            .project-authors
              each author in authors
                .author
                  img(src=author.gravatar)
                  p
                    a.fullname(href=author.url,target="_blank")
                      =author.fullname
                  if author.organisation
                    p
                      a(href=author.organisation.url)
                        .organisation
                          =author.organisation.name
                  if author.biography
                    p.biography
                      =author.biography

      .row
        .col-md-12
          .resource-content

      .row
        .col-md-12.resource-summary
          .h2 Data sources
          .list-group
            each resource in resources
              .list-group-item.list-group-item-action.flex-column.align-items-start.active
                .d-flex.w-100.justify-content-between
                  h5.mb-1
                    =resource.title
                  .btn-group(role="group")
                    a.btn.btn-primary.btn-sm(type="button" href='{{ resource.path }}' download) Download
                    a.btn.btn-primary.btn-sm(type="button" href='{{ project.detail_url }}') Data Package
                  small
                    =resource.mediatype
                if resource.notes
                  p.mb-1
                    =resource.notes

      hr
      .row
        .col-md-3
        .col-md-6
          .card.border-secondary.mb-3.embedding
            .card-header
              a.btn.btn-primary.btn-sm(type="button" target='_blank' href='https://twitter.com/intent/tweet?text={{ project.title }}&hashtags=smartuse&url={{ project.url }}' id='share-project') Tweet
              button.btn.btn-primary.btn-sm(type="button" href='#' id='embed-project') Embed
            |
            .card-body
              a(href='{{ project.url }}')
                h4.card-title
                  =project.title
                |
                img.project-thumb(src='{{ project.thumb() }}',align='left')
                each user in project.users
                  b
                    =user.organisation
                p.card-text
                  =project.summary
